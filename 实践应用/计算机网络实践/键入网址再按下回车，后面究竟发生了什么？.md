# 简介

输入127.0.0.1收到的包
![[Pasted image 20240705180448.png]]
![[Pasted image 20240705180454.png]]
Web服务器的默认端口是80，浏览器使用的端口是55487

# 第一步：tcp连接

HTTP协议是运行在TCP/IP基础上的，依靠TCP/IP协议来实现数据的可靠传输。所以浏览器要用HTTP协议收发数据，首先要做的就是建立TCP连接。因为我们在地址栏里直接输入了IP地址“127.0.0.1”，而Web服务器的默认端口是80，所以浏览器就要依照TCP协议的规范，使用“三次握手”建立与Web服务器的连接。对应到Wireshark里，就是最开始的三个抓包，浏览器使用的端口是52085，服务器使用的端口是80，经过SYN、SYN/ACK、ACK的三个包之后，浏览器与服务器的TCP连接就建立起来了。
![[Pasted image 20240705180514.png]]
这里发生了两次握手，不知道为啥？？？
![[Pasted image 20240705180527.png]]

# 第二步：发送请求报文和收到回复报文

浏览器按照HTTP协议规定的格式，通过TCP发送了一个“GET / HTTP/1.1”请求报文，也就是Wireshark里的第四个包。随后，Web服务器回复了第五个包，在TCP协议层面确认：“刚才的报文我已经收到了”，不过这个TCP包HTTP协议是看不见的。

Web服务器收到报文后在内部就要处理这个请求。同样也是依据HTTP协议的规定，解析报文，看看浏览器发送这个请求想要干什么。它一看，原来是要求获取根目录下的默认文件，好吧，那我就从磁盘上把那个文件全读出来，再拼成符合HTTP格式的报文，发回去吧。这就是Wireshark里的第六个包“HTTP/1.1 200 OK”，底层走的还是TCP协议。同样的，浏览器也要给服务器回复一个TCP的ACK确认，“你的响应报文收到了，多谢”，即第七个包。
![[Pasted image 20240705180549.png]]
中间两条不知道做了啥确认
![[Pasted image 20240705180602.png]]

# 第三步：请求不到资源的情况下

跟第二步类似，重复了相同的步骤。这是浏览器自动请求了作为网站图标的“favicon.ico”文件，与我们输入的网址无关。但因为我们的实验环境没有这个文件，所以服务器在硬盘上找不到，返回了一个“404 Not Found”。
![[Pasted image 20240705180634.png]]
![[Pasted image 20240705180640.png]]

# 总结

再简要叙述一下这次最简单的浏览器HTTP请求过程：

1. 浏览器从地址栏的输入中获得服务器的IP地址和端口号；
2. 浏览器用TCP的三次握手与服务器建立连接；
3. 浏览器向服务器发送拼好的报文；
4. 服务器收到报文后处理请求，同样拼好报文再发给浏览器；
5. 浏览器解析报文，渲染输出页面。